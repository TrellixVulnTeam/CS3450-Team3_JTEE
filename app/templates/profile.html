{% extends "base.html" %}
{% block content %}

<!-- Profile Information -->
  <!-- need to figure out how to align the center div with the sidebars -->
  <div style = "  position: relative;
                  top: 0;
                  right: 0;
                  bottom: 0;
                  left: 0;
                  width: 100%;
                  height: 30%;
                  background-color: #EBF4FA;
                  border-radius: 3px;">
    <img src = {{image_url}} class = "img-rounded" alt="Profile Picture" style = "width:15%; height: 80%;border-radius: 50%;">
    <!-- "https://x1.xingassets.com/assets/frontend_minified/img/users/nobody_m.original.jpg" -->
    <!-- Username div -->
    <div style = "position: absolute;
                  top: 10%;
                  left: 25%;
                  width: 30%;
                  height: 15%;
                  border-radius: 3px;">
      <strong><font size = "6">{{first_name}} {{last_name}}</font></strong>
      <p><b>Email: </b>{{email}}</p>
      <p><b>User Name: </b>{{username}}</p>
    </div>

    <!-- Friends div -->
    <div style = "position: absolute;
                  top: 50%;
                  left: 50%;
                  width: 10%;
                  height: 15%;
                  border-radius: 3px;">
      <strong><a href="{{user_id}}friendsList"><font size = "6">{{friendCount}}</strong></font><font size = "6"></a> Friends</font>
    </div>
    <!-- Edit Profile Button -->
    {% if currentUser == True %}
    <div style = "position: absolute;
                  margin-right: 225px;
                  top: 5%;
                  right: 5%;
                  width: 15%;
                  height: 20%;
                  border-radius: 3px;">
      <button type="button" class="btn btn-primary" id="edit-profile-btn">Edit Profile</button>
    </div>
    <!-- Edit Profile Button -->
    <div style = "position: absolute;
                  margin-right: 225px;
                  top: 20%;
                  right: 5%;
                  width: 15%;
                  height: 20%;
                  border-radius: 3px;">
      <a href="logout" class="btn btn-info" role="button">Logout</a>
    </div>

    <form method="POST" enctype=multipart/form-data action="{{ url_for('upload_photo') }}">
      <input type=file name="file" required>
      <button type="submit" value="Submit" class="btn btn-default btn-primary btn-block photo-upload-btn"><span class="glyphicon glyphicon-pencil"></span> Upload Photo</button>
    </form>

    <!-- Modal -->
      <div class="modal fade" id="editModal" role="dialog">
        <div class="modal-dialog">

          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 style="color:#286090;"><span class="glyphicon glyphicon-lock"></span> Edit Profile</h4>
            </div>
            <div class="modal-body" id="editProfile">
              <form role="form" action="editProfile" method="POST">
                <div class="form-group">
                  <label for="username"><span class="glyphicon glyphicon-user edit-form-btn"></span> Username</label>
                  <input name="username" type="text" class="form-control" id="edit-username" placeholder="Enter Username" value="{{username}}" required>
                </div>
                <div class="form-group">
                  <label for="email"><span class="glyphicon glyphicon-envelope edit-form-btn"></span> Email</label>
                  <input name="email" type="text" class="form-control" id="edit-email" placeholder="Enter Email" value="{{email}}" required>
                </div>
                <div class="form-group">
                  <label for="f-name"> First Name</label>
                  <input name="first_name" type="text" class="form-control" id="edit-firstname" placeholder="Enter First Name" value="{{first_name}}" required>
                </div>
                <div class="form-group">
                  <label for="l-name"> Last Name</label>
                  <input name="last_name" type="text" class="form-control" id="edit-lastname" placeholder="Enter Last Name" value="{{last_name}}" required>
                </div>
                <div class="form-group">
                  <label for="pass"><span class="glyphicon glyphicon-ok-sign edit-form-btn"></span> Password</label>
                  <input name="user_password" type="text" input-type="hidden" class="form-control" id="edit-pass" placeholder="Enter Password" value="{{user_password}}" required>
                </div>
                <!-- <div class="form-group">
                  <label for="c-pass"><span class="glyphicon glyphicon-ok-circle edit-form-btn"></span> Password Confirm</label>
                  <input name="user_password_confirm" type="password" class="form-control" id="edit-confirm-pass" placeholder="Confirm Password" value="{{user_password_confirm}}" oninput="check(this, 'pass2')" required>
                  <script language='javascript' type='text/javascript'>
                    function check(input, pass) {
                        // console.log("input: ", input.value);
                        // console.log("$('#edit-pass').val(): ", $('#edit-pass').val());
                        if (pass == 'pass1') {
                          if (input.value != $('#edit-confirm-pass').val()) {
                              input.setCustomValidity('Password Must be Matching.');
                          } else {
                              // input is valid -- reset the error message
                              input.setCustomValidity('');
                          }
                        } else {
                          if (input.value != $('#edit-pass').val()) {
                              input.setCustomValidity('Password Must be Matching.');
                          } else {
                              // input is valid -- reset the error message
                              input.setCustomValidity('');
                          }
                        }
                    }
                </script>
                </div> -->
                <button type="submit" value="Submit" class="btn btn-default btn-primary btn-block"><span class="glyphicon glyphicon-pencil"></span> Save Changes</button>
              </form>
              {% if error %}
              <h3>{{ error }}</h3>
              {% endif %}
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
              <button id="delete-profile-btn" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Delete This Account</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="deleteModal" role="dialog">
        <div class="modal-dialog">

          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 style="color:#c9302c;"><span class="glyphicon glyphicon-exclamation-sign"></span> Delete Profile?</h4>
            </div>
            <div class="modal-body" id="deleteProfile">
              <h3>Are you sure you would like to delete your profile?  This cannot be undone!</h3>
              <br />
              <form role="form" action="deleteProfile" method="POST">
                <div class="form-group">
                  <label for="email-delete"><span class="glyphicon glyphicon-envelope warning-color"></span> Email/Username</label>
                  <input name="delete_email" type="text" class="form-control" id="delete-email" value="{{request.form.email}}" placeholder="Email/Username of Profile to be Deleted" required>
                </div>
                <div class="form-group">
                  <label for="pass-delete"><span class="glyphicon glyphicon-lock warning-color"></span> Password</label>
                  <input name="delete_pass" type="text" class="form-control" id="delete-pass" value="{{request.form.delete_pass}}" placeholder="Enter Password" required>
                </div>
                <button value="submit" type="submit" class="btn btn-default btn-primary btn-block btn-danger"><span class="glyphicon glyphicon-pencil"></span> DELETE PROFILE</button>
              </form>
            </div>
            <div class="modal-footer">
              <button type="submit" id="delete-cancel-btn" class="btn btn-default btn-default pull-left" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="incorrectPassModal" role="dialog">
        <div class="modal-dialog">

          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 style="color:#c9302c;"><span class="glyphicon glyphicon-exclamation-sign"></span> Delete Profile?</h4>
            </div>
            <div class="modal-body">
              <h3>You have enetered your password and/or email incorrectly.</h3>
              <br />
              <form role="form">
                <button type="submit" class="btn btn-default btn-primary btn-block btn-danger"><span class="glyphicon glyphicon-pencil"></span> OK</button>
              </form>
            </div>
          </div>
        </div>
      </div>

    {% endif %}
    {% if currentUser == False %}
    {% if isFriend == False %}
    <div style = "position: absolute;
                  margin-right: 225px;
                  top: 5%;
                  right: 5%;
                  width: 15%;
                  height: 20%;
                  border-radius: 3px;">
      <a class="btn btn-primary" href="{{user_id}}addFriend" role="button">Add Friend</a>
    {% endif %}
    {% if isFriend == True %}
    <div style = "position: absolute;
                  margin-right: 225px;
                  top: 5%;
                  right: 5%;
                  width: 15%;
                  height: 20%;
                  border-radius: 3px;">
      <a class="btn btn-primary" href="{{user_id}}deleteFriend" role="button">Remove Friend</a>
    {% endif %}
    {% endif %}
  </div>
  <!-- Posts div -->
  <div style = "  position: relative;
                  top: 5%;
                  right: 0;
                  bottom: 0;
                  left: 0;
                  width: 100%;
                  height: 80%;
                  background-color: #EBF4FA;
                  ">
    <!-- Recent Posts -->
    <!-- Write a post... -->

      {% if currentUser == True %}
      <div id = "write-container">
         <h2>
           Post History <br>
         </h2>
         <form action="\postCreate" method = "POST">
           <textarea cols = "50" rows = "6" value = "{{request.form.post}}" name = "post" placeholder="Write a Post" ></textarea>
           <input type="submit" value="Submit">
         </form>
      </div>
      {% endif %}

      {% for post in posts %}
            <div id = "post-container">
              <h4>{{username}}:</h4><br>
              <p>{{post}}</b></p>
            </div>
      {% endfor %}

    </div>
  </div>

<script>
$(document).ready(function(){
    console.log("urL :", window.location.href.search(/pass_error/i))
    if (window.location.href.search(/pass_error/i) == -1) {
        console.log("Everything is just fine ;)")
    } else {
      console.log("Email and/or Password was incorrect!");
      $("#incorrectPassModal").modal();
    }
    $("#edit-profile-btn").click(function(){
        $("#editModal").modal();
    });
    $("#delete-cancel-btn").click(function(){
        $("#editModal").modal();
    });
    $("#delete-profile-btn").click(function(){
        $("#deleteModal").modal();
    });
});
</script>
{% endblock %}
